import type { NextPage } from "next";
import Head from "next/head";

import { UnorderedList, ListItem, useMediaQuery } from "@chakra-ui/react";

import useSWR from "swr";
import { pokeApi } from "services/pokeApi";
import { AxiosResponse } from "axios";
import type { BasePokemonEntity } from "../types/BasePokemonEntity";
import type { PokeApiListResponse } from "../types/PokeApiListResponse";
import { PokemonCard } from "components/PokemonCard";

const Home: NextPage = () => {
  const { data, error } = useSWR<
    AxiosResponse<PokeApiListResponse<BasePokemonEntity[]>>
  >("/pokemon", (url) => pokeApi.get(url));

  const [isSmallerThan800] = useMediaQuery("(max-width: 800px)");

  return (
    <>
      <Head>
        <title>Pokedex | Main</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <UnorderedList
        as="ul"
        display="flex"
        justifyContent="center"
        width={isSmallerThan800 ? "100%" : "80%"}
        bg="gray.50"
        height="100%"
        flexWrap="wrap"
        gap="10"
        p="10"
        m={0}
        data-testid="pokemon-list"
      >
        {data?.data.results.map((item) => (
          <PokemonCard key={item.name} pokemon={item} />
        ))}
      </UnorderedList>
    </>
  );
};

export default Home;
